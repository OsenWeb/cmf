{%- macro generateHref(item) -%}
{% spaceless %}
    {% if item.type %} 
        {% if item.type.id == 1 %}
            {{ item.getHref() }}
        {% elseif item.type.id == 2 %}
            {{ app.request.getBasePath() ~ (app.environment == 'dev' ? '/app_dev.php') ~ (app.request.getLocale() ? '/'~ app.request.getLocale() : '') ~'/'~ item.getHref() }}
        {% elseif item.type.id == 3 %}
            {{ path('page', {'slug': item.page.slug}) }}
        {% elseif item.type.id == 4 %}
            {{ path('article', {'slug': item.article.slug}) }}
        {% elseif item.type.id == 5 %}
            {{ path('articles') }}
        {% endif %}
    {% endif %}
{% endspaceless %}
{%- endmacro -%}

{% macro menuRecursion(items, level = 1) %}
    <ul class="level_{{ level }}">
        {% for item in items %}
            <li class="item_{{ item.current.id }}{% if item.current.class %} {{ item.current.class }}{% endif %}">
                <a href="{{- _self.generateHref(item.current) -}}"{% if item.current.title %} title="{{ item.current.title }}"{% endif %}{% if item.current.inNew %} target="_blank"{% endif %}>{{ item.current.name }}</a>
                {% if item.children is defined %}
                    {{ _self.menuRecursion(item.children, level + 1) }}
                {% endif %}
            </li>
        {% endfor %}
    </ul>
{% endmacro %}

{% if heading is not sameas(false) %}
    <h3>{{ heading ? heading : menu.name }}</h3>
{% endif %}
{{ _self.menuRecursion(items) }}
<div class="clear"></div>